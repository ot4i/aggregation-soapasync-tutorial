<!DOCTYPE html>
<html class="no-js" lang="en">
 
	
<!-- header::Start -->
	<head>
		<!-- Use Internet Explorer 9 Standards mode for Eclipse Browser Control - https://www.eclipse.org/swt/faq.php#browsernativeie and https://msdn.microsoft.com/en-us/library/jj676915%28v=vs.85%29.aspx -->
  		<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
		
		<!-- Next 2 http=equiv headers required to disable caching the Eclipse Browser Widget -->
		<meta http-equiv="Pragma" content="no-cache">
  		<meta http-equiv="Expires" content="-1">

		<meta charset="UTF-8"> 
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<meta name="copyright" content="Copyright IBM Corporation 2014" />
		<meta name="abstract" content="IBM Integration Bus V10 Tutorial">
		<meta name="author" content="IBM">
		<meta name="description" content="IBM Integration Bus V10 Tutorial">
		<meta name="keywords" content="keywords" > 
		<meta name="robots" content="index,follow">
		<meta name="source" content="IBM Integration Bus V10 Tutorial" /> 
		
		<title>IBM Integration Bus V10 Tutorial</title>

    	<link rel="stylesheet" href="http://ot4i.github.io/iib-tutorials/css/main.css" />
		<link rel="stylesheet" href="http://ot4i.github.io/iib-tutorials/css/app.css" />
    	
		<script src="http://ot4i.github.io/iib-tutorials/js/json2.js"></script>
		<script src="http://ot4i.github.io/iib-tutorials/js/js2java.js"></script>
		<script src="http://ot4i.github.io/iib-tutorials/js/js2java_steps.js"></script>
		<script src="http://ot4i.github.io/iib-tutorials/js/vendor/modernizr.js"></script>
	</head>
<!-- header::End -->
<!-- body::Start -->
		<body>
  	<!-- body content here -->
	<div class="row">
	  <div class="small-12 medium-12 large-12 columns">
	    <p> </p>
	  </div>
	</div>
	<div class="row">
	  <div class="small-9 medium-9 large-9 columns">
	    <h4 class="title">Using the Aggregation nodes in a message flow, with SOAP/HTTP transport to back-end services <action><button class="small radius button" tabindex="0" id="stepsViewDetails" onclick="viewDetails()"> View Details</button> </action></h4>
	  </div>
	  <div class="small-3 medium-3 large-3 columns">
		<a href="javascript:;" onclick="openHelpSystem('/com.ibm.etools.msgbroker.helphome.doc/help_home_msgbroker.htm')" class="small right helplink">IBM Knowledge Center</a> 
	  </div>
	</div> 
	<hr>
	<div class="row">
		<div class="small-10 medium-10 large-10 columns">
		<h5> Learn how to use the Aggregation nodes to fan-out and fan-in messages over SOAP/HTTP. </h5>
		</div>
		<div class="small-2 medium-2 large-2 columns">
			<button class="small radius button right" tabindex="0" id="backToGallery" onclick="backToGallery()"> Back To Gallery
			</button>
		</div>
	</div>
	<div class="row">          
		  <div class="small-12 medium-12 large-12 columns">
			<ul class="tabs vertical"> 
				<li class="tab-title tab-title-small active">
				  <a href="javascript:;" onclick="show('panel21')">Create</a> 
				</li>
				<li class="tab-title tab-title-small">
				  <a href="javascript:;" onclick="show('panel31')">Prepare</a> 
				</li>
				<li class="tab-title tab-title-small">
				  <a href="javascript:;" onclick="show('panel41')">Run</a> 
				</li>
			</ul>
			<!-- editing -->
			<div class="tabs-content panel-thin-blue vertical"> 
		    	<div class="content active" id="panel21">
		    		
		    		<div class="small-10 medium-10 large-10 columns divider">
					
				      	<div class="row content-details">
					      	<h4>Import projects</h4>
					        
						    
								<p> When you click Import, three Integration Services and one shared library will be created in your workspace: </p>
								
							
								<p> The Integraion Service <span class="application">AggregationSOAPAsync</span> provides a single operation named getAggregatedResponseOperation. The subflow representation of the operation uses SOAPAsyncRequest nodes to fan-out two requests. Two SOAPAsyncResponse nodes are used to fan-in reply messages from the back-end message flows. </p>
								
							
								<p> The Integration Service <span class="application">AggregationSOAPBackend1</span> provides a single operation named backendOperation1 whose subflow representation uses a Mapping node to upper-case the input data. </p>
								
							
								<p> The Integration Service <span class="application">AggregationSOAPBackend2</span> provides a single operation named backendOperation2 whose subflow representation uses a Mapping node to upper-case the input data. </p>
								
							
								<p> For simplicity, the three Integration Services can all be deployed to the same integration server. If you wish, you could deploy AggregationSOAPBackend1 and AggregationSOAPBackend2 to different integration servers. </p>
								
							
								<p> Once you import the tutorial, the provided applications are ready to be deployed and tested. Before you do this, you need to create the required MQ queues, as described on the Prepare tab. </p>
								
							
						</div>
						
						<div class="row content-details">
							<h4>Find out more</h4>
							<ul>
							
								
																
								<li> <a href="javascript:;" onclick="openHelpSystem('/com.ibm.etools.mft.doc/bi12001_.htm')" title="Knowledge Center link to Developing integration solutions by using integration services">Developing integration solutions by using integration services</a> </li>
							   	
							
							</ul>
						</div>
						
					</div>
					
					<div class="small-2 medium-2 large-2 columns">
					
					
					<h4 class="tkaction"><a href="javascript:;" onclick="importArtifacts(); openResource('MainFlow')"> Import <img class="icon-image" src="http://ot4i.github.io/iib-tutorials/images/icons/ibmdesign/back-right-previous_128-orange.png"></a></h4>
										
				    </div>
					
		    	</div>
		    	<div class="content" id="panel31">
					
					<div class="small-12 medium-12 large-12 columns">
					
						<div class="row content-details">
						  	<h4>Create queues</h4>
						    
						    
								<p> Although this solution uses Callable Flows to route messages between the REST API and applications, the aggregation nodes require MQ queues to operate. </p>
								
								
									
									<ol>
									
									
										<li> Create the default IBM Integration Bus queues in WebSphere MQ by completing the following steps:
										
										
											
											<ol>
											
												
													<li> Open the IBM Integration Console.</li>
												
													<li> In the console window, type the following command:<br><code>server\sample\wmq\iib_createqueues <span class="varname">qmgr</span></code><br>where<br><span class="varname">qmgr</span> is the queue manager name.</li>
												
											
											</ol>
											
										
										</li>
									
										<li> Associate the default integration node with the queue manager by completing the following steps:
										
										
											
											<ol>
											
												
													<li> In the console window, stop the default integration node by typing the following command:<br><code><span class="cmdname">mqsistop</span> -i <span class="varname">TESTNODE_userid</span></code></li>
												
													<li> Associate the queue manager with the default integration node, <span class="varname">TESTNODE_userid</span> by typing the following command:<br><code><span class="cmdname">mqsichangebroker</span> <span class="varname">TESTNODE_userid</span> -q <span class="varname">qmgr</span></code><br>where<br><span class="varname">qmgr</span> is the queue manager name</li>
												
													<li> Start the default integration node by typing the following command:<br><code><span class="cmdname">mqsistart</span> <span class="varname">TESTNODE_userid</span></code></li>
												
											
											</ol>
											
										
										</li>
									
									
									</ol>
									
								
							
						</div>
						
						<div class="row content-details">
							<h4></h4>
							<ul>
							
							</ul>
						</div>
							
					</div>
					
		    	</div>
		    	<div class="content" id="panel41">
		    		
		    		<div class="small-10 medium-10 large-10 columns divider">
					
				    	<div class="row content-details">
					      	<h4></h4>
					        
						    
								<p> <h4>Deploy the back-end Callable Flow Applications</h4> </p>
								
								
									
									<ol>
									
									
										<li> Deploy the <span class="application">AggregationCallableAsyncBackend1</span> application, by dragging and dropping it on to the default integration server.
										
										</li>
									
										<li> Deploy the <span class="application">AggregationCallableAsyncBackend2</span> application, by dragging and dropping it on to the default integration server.
										
										</li>
									
									
									</ol>
									
								
							
								<p> <h4>Use any web browser to simply test the REST API </h4></p>
								
								
									
									<ol>
									
									
										<li> Look inside the <span class="resource">AggregationCallableAsync</span> REST API, right-click the <span class="resource">AggregationCallableAsync.msgflow</span> and select <span class="resource">Open with > Message Flow Editor</span>.
										
										
											
											<ul>
											
												
													<li> Click the Flow Exerciser icon <img src="http://ot4i.github.io/ot4i.tutorials//dist/images/icons/iib/startFlowExerciser.png" alt> to start testing the flow</li>
												
											
											</ul>
											
										
										</li>
									
										<li> Open any web browser. We will be using this to send an HTTP GET into the REST API <span class="resource">AggregationCallableAsync</span>.
										
										
											
											<ul>
											
												
													<li> In the address bar of the browser paste in the URL for the HTTP GET operation. If you have used default settings, then this is likely to be:</li>
												
													<li> http://localhost:7080/aggregationcallableasync/v1/AggregatedResponse?Field1=value1&Field2=value2</li>
												
													<li> Note that this URL includes query parameters with the values <span class="resource">value1</span> and <span class="resource">value2</span>. One of these values will be sent to each back-end flow. The back end flows will uppercase the values and reply.</li>
												
											
											</ul>
											
										
										</li>
									
										<li> Return to <span class="resource">AggregationCallableAsync.msgflow</span>.
										
										
											
											<ul>
											
												
													<li> Click the View Path icon <img src="http://ot4i.github.io/ot4i.tutorials//dist/images/icons/iib/viewPath.png" alt> to see the path which the message took through the flow and see the message content on the path. You can open the subflow <span class="resource">getAggregatedResponse.subflow</span> and click on the flow connections to see what the message tree looked like as it traversed through the REST API.</li>
												
													<li> Back in the web browser, you should see the final output message carries return data from both of the back-end callable message flows which has been changed to upper case. It should look like this:</li>
												
													<li> <span class="resource">{&quot;ResponseBackend1&quot;:&quot;VALUE1&quot;,&quot;ResponseBackend2&quot;:&quot;VALUE2&quot;}</span></li>
												
											
											</ul>
											
										
										</li>
									
									
									</ol>
									
								
							
								<p> This tutorial has shown the Aggregation nodes orchestrating an asynchronous fan-out and an associated fan-in of messages to Callable Flows. </p>
								
							
						</div>
						
						<div class="row content-details"> 	
							<h4>Find out more</h4>
							<ul>
							
								
																
								<li> <a href="javascript:;" onclick="openHelpSystem('/com.ibm.etools.mft.doc/ac00660_.htm')" title="Knowledge Center link to Message Flow Aggregation">Message Flow Aggregation</a> </li>
							   	
							
							</ul>
						</div>
							
					</div>
					
					<div class="small-2 medium-2 large-2 columns">
					
					
					
					
					
					<h4 class="tkaction"><a href="javascript:;" onclick="cleanUp()" title="Clean up and remove any changes in your workspace made by the tutorial."> Clean Up <img class="icon-image" src="http://ot4i.github.io/iib-tutorials/images/icons/ibmdesign/close-cancel-error_128-red.png"></a></h4>
				    
					
				    </div>
					
				</div>	
			</div> <!-- tab-content -->
		</div> <!-- columns -->
	  </div> <!-- row --></body>
		<script src="http://ot4i.github.io/iib-tutorials/js/vendor/jquery.js"></script>
		<script src="http://ot4i.github.io/iib-tutorials/js/vendor/foundation.min.js"></script>
		<script src="http://ot4i.github.io/iib-tutorials/js/main.js"></script>
	</body>
<!-- body::End -->

</html>